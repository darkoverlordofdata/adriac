#!/usr/bin/env node
// Generated by CoffeeScript 2.0.0-alpha1

/*
## Copyright (c) 2017 Bruce Davidson &lt;darkoverlordofdata@gmail.com&gt;
## GPL3
##
##  Phase I - preprocess for valac
##
## Injects reference counting boilerplate into classes that sublcass Object
##
##  <ClassName> : Object
##
 */

(function() {
  var file, files, fs, i, klass, len, name, namespace, options, path, ref;

  fs = require('fs');

  path = require('path');

  options = {};

  files = decodeURIComponent(process.argv[2]);

  if (files[0] === '"') {
    files = files.slice(1, -1);
  }

  ref = files.split(" ");
  for (i = 0, len = ref.length; i < len; i++) {
    file = ref[i];
    switch (path.extname(file)) {
      case '.gs':
        klass = path.basename(file, '.gs');
        if (klass[0] >= 'A' && klass[0] <= 'Z') {
          name = klass.toLowerCase();
          namespace = path.dirname(file).substring(10);
          require('./boilerplate').gs(file, {
            ext: 'gs',
            "class": klass,
            name: name,
            namespace: namespace
          });
        }
        break;
      case '.vala':
        klass = path.basename(file, '.vala');
        if (klass[0] >= 'A' && klass[0] <= 'Z') {
          name = klass.toLowerCase();
          namespace = path.dirname(file).substring(10);
          require('./boilerplate').vala(file, {
            ext: 'vala',
            "class": klass,
            name: name,
            namespace: namespace
          });
        }
    }
  }

}).call(this);
